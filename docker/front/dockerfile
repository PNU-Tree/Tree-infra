# 1. Node.js 이미지를 베이스로 사용
FROM node:16-alpine

# 2. 작업 디렉터리 생성
WORKDIR /app

# 3. package.json과 package-lock.json을 복사한 후 의존성 설치
COPY package*.json ./
RUN npm install

# 4. 소스 코드를 복사
COPY . .

# 5. TypeScript 빌드를 위해 필요한 컴파일 도구 설치
RUN npm install typescript -g

# 6. TypeScript를 JavaScript로 컴파일
RUN npm run build

# 7. 포트를 설정 (Express 서버가 사용하는 포트)
EXPOSE 3000

# 8. 컨테이너가 시작되면 npm start로 서버 실행
CMD ["npm", "run", "start"]
